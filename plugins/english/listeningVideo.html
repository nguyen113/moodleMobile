<script>
	var player; 
	var playerState;
	var timeupdater = null;
	var videotime = 0;
	var questions=<%= questions %>;
	function getPoint(){
	//array nhung dap an da chon
	var choiced;
	//dap an dung
	var corrects;
	for (var i=0;i<questions.length; i++){
		correct[i] = questions[i].correct;
	}
	var tpl = {
		choiced: choiced,
		correct: correct
	}
	
		MM.panels.html('right', '');
		var html = MM.tpl.render(MM.plugins.english.templates.score.html, tpl);
		MM.panels.show('right', html);
		
	}
	function sortListByTime(list)
	{
		for (var i = 0; i<list.length; i++)
		{
			for(var j = i+1; j<list.length; j++){
				if(list[i].time < list[j].time){
					var t = list[i];
					list[i] = list[j];
					list[j] = t;
				}
			}
		}
		return list;
	}
	console.log("videoID = "+<%= id %>);
	var req = {"get_content_by_video":<%= id %>};
	MM.englishWSCall(req, function(data){
		$('.content-message').append('<h1>'+data+'</h1>');
	});
	var tempList = sortListByTime(questions);
	var index = 0;
	function onPlayerReady(event) {
		MM.panels.html('center', '');
		MM.panels.htmlPrepend("center",'<input type="button" width="100%" value="END" onclick></input>');
		playerState = -1;
		function updateTime() {
			var oldTime = videotime;
			if(player && player.getCurrentTime) {
				videotime = player.getCurrentTime();
			}
			if(videotime !== oldTime) {
				onProgress(videotime);
			}
		}
		function onProgress(videotime){
			var currentTime=Math.round(videotime);
			if(currentTime==tempList[index].time){
				console.log("Current time " + player.getCurrentTime() );
				MM.panels.htmlPrepend("center",'<h2>'+tempList[index].question+'</h2><p><div id="radio"><input type="radio" id="radio1" name="radio'+index+'"><label for="radio1">'+tempList[index].answera+'</label></p><p><input type="radio" id="radio2" name="radio'+index+'" checked="checked"><label for="radio2">'+tempList[index].answerb+'</label></p><p><input type="radio" id="radio3" name="radio'+index+'"><label for="radio3">'+tempList[index].answerc+'</label></p><p></div><input type="radio" id="radio4" name="radio'+index+'"><label for="radio4">'+tempList[index].answerd+'</label></div></p>');
				index++;
			}
		}
		timeupdater = setInterval(updateTime, 1000);
	}
	
</script>
<div class="content-index">
		<div class="video">
            <div class="nav nav-v">
				<div id="player">
					<div id="displayDiv">
						<div id="title">Rihanna - Take A Bow</div>
					</div>
				</div>             
            </div>
		</div>
</div>
<div class="content-message" id="content-message"> 

</div>
<script>
	player = new YT.Player("player",{width: "100%",videoId: "<%= videoID %>",events: {
		'onReady': onPlayerReady
    }});
</script>
